{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport { useToast } from \"vue-toastification\";\nexport default {\n  components: {},\n  name: \"profile_change\",\n  props: ['slug'],\n  data: () => ({\n    user: {},\n    cur_user: {},\n    username: \"\",\n    password: \"\",\n    email: \"\",\n    error: \"\",\n    msg: [],\n    oldpas: '',\n    newpas: '',\n    loading: false,\n    toast: useToast()\n  }),\n  watch: {\n    email(value) {\n      // binding this to the data value in the email input\n      this.email = value;\n      this.validateEmail(value);\n    }\n  },\n  created() {\n    this.loadUser();\n  },\n  methods: {\n    async loadUser() {\n      const response = await fetch(this.$store.state.backendUrl + `api/v1/${this.slug}/`, {\n        method: 'GET',\n        headers: {\n          'Content-type': 'application/json'\n        }\n      }).then(response => response.json()).catch(err => {\n        let r = this.$router.resolve({\n          name: '404'\n        });\n        this.$router.push(r);\n      });\n      this.user = response;\n      this.username = response.username;\n      this.email = response.email;\n      this.cur_user = this.$store.state.cuser;\n      if (this.user.email !== this.cur_user.email) {\n        let r = this.$router.resolve({\n          name: '404'\n        });\n        this.$router.push(r);\n      }\n    },\n    update: function () {\n      if (!this.msg['email'] && this.user.email == this.cur_user.email) {\n        const formData = new FormData();\n        formData.append(\"email\", this.email);\n        this.loading = true;\n        axios({\n          url: this.$store.state.backendUrl + `api/v1/profile_edit/${this.user.slug}/`,\n          data: formData,\n          method: 'PUT'\n        }).then(resp => {\n          console.log(resp), this.loading = false;\n          let r = this.$router.resolve({\n            name: 'Home' // put your route information in\n          });\n          this.$router.push(r);\n        }).catch(err => {\n          this.toast.error(\" Помилка. Введіть валідні дані або спробуйте пізніше \"), this.loading = false;\n        });\n      } else {\n        this.toast.error(\" Помилка. Введіть валідні дані або спробуйте пізніше \");\n      }\n    },\n    validateEmail(value) {\n      if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(value)) {\n        this.msg['email'] = '';\n      } else {\n        this.msg['email'] = 'Це не схоже на email';\n      }\n    },\n    resetPassword() {\n      const formData = new FormData();\n      this.loading = true;\n      formData.append('email', this.user.email);\n      axios({\n        url: this.$store.state.backendUrl + `auth/users/reset_password/`,\n        data: formData,\n        method: 'POST'\n      }).then(resp => {\n        this.loading = false;\n        this.toast.success('На Вашу пошту було надіслано посилання для зміни пароля');\n        console.log(resp);\n      }).catch(err => (this.loading = false, console.log(err), this.toast.error('Помилка!')));\n    }\n  }\n};","map":{"version":3,"names":["axios","useToast","components","name","props","data","user","cur_user","username","password","email","error","msg","oldpas","newpas","loading","toast","watch","value","validateEmail","created","loadUser","methods","response","fetch","$store","state","backendUrl","slug","method","headers","then","json","catch","err","r","$router","resolve","push","cuser","update","formData","FormData","append","url","resp","console","log","test","resetPassword","success"],"sources":["/home/oliverqa/Documents/engee_frontend/src/views/profile.vue"],"sourcesContent":["<template>\r\n     <div v-if=\"loading\" class=\"preloader\">\r\n    <div class=\"preloader__image\">\r\n    </div>\r\n</div>\r\n      <body style=\"height: 100%\" class=\"bg-default\">\r\n  <!-- Navbar -->\r\n\r\n  <!-- Main content -->\r\n  <div class=\"main-content\">\r\n    <!-- Header -->\r\n\r\n    <div class=\"header bg-gradient-primary py-7 py-lg-8 pt-lg-9\">\r\n      <div class=\"container\">\r\n        <div class=\"header-body text-center mb-7\">\r\n          <div class=\"row justify-content-center\">\r\n\r\n<div class=\"container\">\r\n            <div class=\"section-header\">\r\n                <h2 style=\"color: mintcream\">Зміна профіля</h2>\r\n            </div>\r\n            <div class=\"container\">\r\n                <div class=\"main-body\">\r\n                    <div class=\"row gutters-sm\">\r\n                        <div class=\"col-md-4 mb-3\">\r\n                            <div data-aos=\"slide-right\" data-aos-delay=\"200\" class=\"card\">\r\n                                <div class=\"card-body\">\r\n                                    <div class=\"d-flex flex-column align-items-center text-center\">\r\n\r\n                                        <div class=\"mt-3\">\r\n                                            <h4 > {{user.username}}</h4>\r\n                                          <div><button class=\"btn btn-dark\" @click=\"resetPassword\">Змінити пароль</button> </div>\r\n                                        <button @click=\"update\" class=\"btn btn-primary\">Зберегти</button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-md-8\">\r\n                            <div data-aos=\"slide-left\" data-aos-delay=\"200\" class=\"card mb-3\">\r\n                                <div class=\"card-body\">\r\n                                    <div class=\"row \">\r\n                                        <div class=\"col-sm-3 \">\r\n                                            <h3 class=\" mb-0\">Email</h3>\r\n                                        </div>\r\n                                        <div class=\"col-sm-9 text-secondary\">\r\n                                            <input type=\"email\" v-model=\"email\" class=\"form-control\" placeholder=\"email\"  required/>\r\n                                                                <span v-if=\"msg.email\">{{msg.email}}</span>\r\n\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"separator separator-bottom separator-skew zindex-100\">\r\n        <svg x=\"0\" y=\"0\" viewBox=\"0 0 2560 100\" preserveAspectRatio=\"none\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n          <polygon class=\"fill-default\" points=\"2560 0 2560 100 0 100\"></polygon>\r\n        </svg>\r\n      </div>\r\n    </div>\r\n    <!-- Page content -->\r\n    <div class=\"container \">\r\n      <div class=\"row\">\r\n\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n\r\n\r\n<footer class=\"py-5\" id=\"footer-main\">\r\n    <div class=\"container\">\r\n      <div class=\"row align-items-center justify-content-xl-between\">\r\n        <div class=\"col-xl-6\">\r\n          <div class=\"copyright text-center text-xl-left text-muted\">\r\n            &copy; 2024 <a href=\"https://github.com/elaiviaien\" class=\"font-weight-bold ml-1\" target=\"_blank\">elaiviaien</a>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-xl-6\">\r\n          <ul class=\"nav nav-footer justify-content-center justify-content-xl-end\">\r\n            <li class=\"nav-item\">\r\n              <a  class=\"nav-link\" target=\"_blank\">elaiviaien</a>\r\n            </li>\r\n            <li class=\"nav-item\">\r\n              <a href=\"https://t.me/liumphis\" class=\"nav-link\" target=\"_blank\">Співпраця</a>\r\n            </li>\r\n            <li class=\"nav-item\">\r\n              <a href=\"http://hiker.elaiviaien.com\" class=\"nav-link\" target=\"_blank\">Сайт для туризму</a>\r\n            </li>\r\n            <li class=\"nav-item\">\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </footer></body>\r\n</template>\r\n<script>\r\n    import axios from \"axios\";\r\n\r\n    import {useToast} from \"vue-toastification\";\r\n\r\n    export default {\r\n        components: {\r\n        },\r\n        name: \"profile_change\",\r\n        props:['slug'],\r\n        data: () => ({\r\n            user:{},\r\n            cur_user:{},\r\n            username:\"\",\r\n            password:\"\",\r\n            email:\"\",\r\n            error:\"\",\r\n                    msg:[],\r\n          oldpas:'',\r\n          newpas:'',\r\n          loading:false,\r\n\t\t\ttoast : useToast(),\r\n        }),\r\n        watch: {\r\n            email(value){\r\n                // binding this to the data value in the email input\r\n                this.email = value;\r\n                this.validateEmail(value);\r\n            },\r\n},\r\n        created() {\r\n            this.loadUser()\r\n        },\r\n\r\n      methods: {\r\n\r\n             async loadUser() {\r\n\r\n                const response = await fetch( this.$store.state.backendUrl+`api/v1/${this.slug}/`,{ method: 'GET',headers: {'Content-type': 'application/json',}}).then(response=>response.json()).catch(err =>{\r\n                            let r = this.$router.resolve({\r\n\t\t\t\t\t\t\t\tname: '404',\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.$router.push(r)\r\n                })\r\n               this.user  = response\r\n                    this.username = response.username\r\n                    this.email= response.email\r\n                       this.cur_user = this.$store.state.cuser\r\n                 if(this.user.email !== this.cur_user.email){\r\n                                let r = this.$router.resolve({\r\n\t\t\t\t\t\t\t\tname: '404',\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.$router.push(r)\r\n                 }\r\n                },\r\n\r\n            update: function () {if(!this.msg['email'] && this.user.email == this.cur_user.email){\r\n                const formData = new FormData();\r\n\r\n                formData.append(\"email\", this.email);\r\n\r\n                this.loading = true\r\n                axios({url: this.$store.state.backendUrl+`api/v1/profile_edit/${this.user.slug}/`, data:formData, method: 'PUT' }).then(resp =>{console.log(resp), this.loading =false\r\n\t\t\t\t\t\t\tlet r = this.$router.resolve({\r\n\t\t\t\t\t\t\t\tname: 'Home', // put your route information in\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.$router.push(r)\r\n\t\t\t\t\t\t\t})\r\n             .catch(err => {this.toast.error(\" Помилка. Введіть валідні дані або спробуйте пізніше \"),  this.loading =false})}\r\n                             else {\r\n                this.toast.error(\" Помилка. Введіть валідні дані або спробуйте пізніше \")\r\n                }\r\n\r\n        },\r\n            validateEmail(value){\r\n      if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(value))\r\n  {\r\n    this.msg['email'] = '';\r\n  } else{\r\n    this.msg['email'] = 'Це не схоже на email';\r\n  }\r\n    },\r\n        resetPassword(){\r\n                  const formData = new FormData();\r\n                  this.loading = true\r\n                    formData.append('email', this.user.email);\r\n                                    axios({url: this.$store.state.backendUrl+`auth/users/reset_password/`, data:formData, method: 'POST' }).then(resp => {\r\n                                      this.loading =false\r\n                                      this.toast.success('На Вашу пошту було надіслано посилання для зміни пароля')\r\n                                      console.log(resp)}\r\n                                    ).catch(err =>( this.loading = false, console.log(err), this.toast.error('Помилка!')))\r\n        }\r\n\r\n    }}\r\n</script>\r\n\r\n<style scoped>\r\n#upload_pr {\r\n   opacity: 0;\r\n   position: absolute;\r\n   z-index: -1;\r\n}\r\n.btn{\r\n  margin: 1%;\r\n}\r\n  .preloader {\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    overflow: hidden;\r\n    background: #fff;\r\n    z-index: 1001;\r\n        opacity: 50%;\r\n\r\n  }\r\n\r\n  .preloader__image {\r\n    position: relative;\r\n    top: 50%;\r\n    left: 50%;\r\n    width: 64px;\r\n    height: 64px;\r\n    margin-top: -32px;\r\n    margin-left: -32px;\r\n    background: url('../assets/Walk.gif') no-repeat 50% 50%;\r\n    /*расположение (url) изображения gif и др. параметры*/\r\n  }\r\n\r\n  .loaded_hiding .preloader {\r\n    transition: 0.3s opacity;\r\n    opacity: 0;\r\n  }\r\n\r\n\r\n.profile_text{\r\n    background-color:mintcream ;\r\n    border-radius: 5px;\r\n    color: #384452;\r\n    padding: 1%;\r\n  }\r\n#footer-main{\r\n  position: absolute;\r\n  bottom: 0;\r\n  width: 100%;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}